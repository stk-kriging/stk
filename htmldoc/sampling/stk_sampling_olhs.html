<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of stk_sampling_olhs</title>
  <meta name="keywords" content="stk_sampling_olhs">
  <meta name="description" content="STK_SAMPLING_OLHS generates a random Orthogonal Latin Hypercube (OLH) sample">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">sampling</a> &gt; stk_sampling_olhs.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for sampling&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>stk_sampling_olhs
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>STK_SAMPLING_OLHS generates a random Orthogonal Latin Hypercube (OLH) sample</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function x = stk_sampling_olhs(n, d, box, permut) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> STK_SAMPLING_OLHS generates a random Orthogonal Latin Hypercube (OLH) sample

 CALL: X = stk_sampling_olhs(N)

    generates a random Orthogonal Latin Hypercube (OLH) sample X, using the
    construction of Ye (1998). The algorithm only works for sample sizes N
    of the form 2^(R+1)+1, with R &gt;= 1. Trying to generate an OLHS with a 
    value of N that is not of this form generates an error. The number of 
    factors is D = 2*R, and the OLHS is defined on [-1; 1]^D.

 CALL: X = stk_sampling_olhs(N, D)

    does exactly the same thing, provided that there exists an integer R
    such that N = 2^(R+1)+1 and D = 2*R (or D is empty).

 CALL: X = stk_sampling_olhs(N, D, BOX)

    generates an OLHS on BOX. Again, D can be empty since the number of
    factors can be deduced from N.

 CALL: X = stk_sampling_olhs(N, D, BOX, PERMUT)

    uses a given permutation PERMUT, instead of a random permutation, to 
    initialize the construction of Ye (1998). As a result, the generated
    OLHS is not random anymore. PERMUT must be a permutation of 1:2^R. If
    BOX is empty, then the default domain [-1, 1]^D is used.

 NOTE: orthogonality

    The samples generated by this functions are only orthogonal, stricty-
    speaking, if BOX is a symmetric domain (e.g., [-1, 1]^D). Otherwise,
    the generated samples shound be called &quot;uncorrelated&quot;.

 REFERENCE: 

    Kenny Q. Ye, &quot;Orthogonal Column Latin Hypercubes and Their 
    Application in Computer Experiments&quot;, Journal of the American 
    Statistical Association, 93(444), 1430-1439, 1998.
    http://dx.doi.org/10.1080/01621459.1998.10473803

 See also: <a href="stk_sampling_randomlhs.html" class="code" title="function x = stk_sampling_randomlhs(n, dim, box)">stk_sampling_randomlhs</a>, <a href="stk_sampling_maximinlhs.html" class="code" title="function x = stk_sampling_maximinlhs(n, d, box, niter)">stk_sampling_maximinlhs</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% STK_SAMPLING_OLHS generates a random Orthogonal Latin Hypercube (OLH) sample</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% CALL: X = stk_sampling_olhs(N)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%    generates a random Orthogonal Latin Hypercube (OLH) sample X, using the</span>
0006 <span class="comment">%    construction of Ye (1998). The algorithm only works for sample sizes N</span>
0007 <span class="comment">%    of the form 2^(R+1)+1, with R &gt;= 1. Trying to generate an OLHS with a</span>
0008 <span class="comment">%    value of N that is not of this form generates an error. The number of</span>
0009 <span class="comment">%    factors is D = 2*R, and the OLHS is defined on [-1; 1]^D.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% CALL: X = stk_sampling_olhs(N, D)</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%    does exactly the same thing, provided that there exists an integer R</span>
0014 <span class="comment">%    such that N = 2^(R+1)+1 and D = 2*R (or D is empty).</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% CALL: X = stk_sampling_olhs(N, D, BOX)</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%    generates an OLHS on BOX. Again, D can be empty since the number of</span>
0019 <span class="comment">%    factors can be deduced from N.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% CALL: X = stk_sampling_olhs(N, D, BOX, PERMUT)</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%    uses a given permutation PERMUT, instead of a random permutation, to</span>
0024 <span class="comment">%    initialize the construction of Ye (1998). As a result, the generated</span>
0025 <span class="comment">%    OLHS is not random anymore. PERMUT must be a permutation of 1:2^R. If</span>
0026 <span class="comment">%    BOX is empty, then the default domain [-1, 1]^D is used.</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% NOTE: orthogonality</span>
0029 <span class="comment">%</span>
0030 <span class="comment">%    The samples generated by this functions are only orthogonal, stricty-</span>
0031 <span class="comment">%    speaking, if BOX is a symmetric domain (e.g., [-1, 1]^D). Otherwise,</span>
0032 <span class="comment">%    the generated samples shound be called &quot;uncorrelated&quot;.</span>
0033 <span class="comment">%</span>
0034 <span class="comment">% REFERENCE:</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%    Kenny Q. Ye, &quot;Orthogonal Column Latin Hypercubes and Their</span>
0037 <span class="comment">%    Application in Computer Experiments&quot;, Journal of the American</span>
0038 <span class="comment">%    Statistical Association, 93(444), 1430-1439, 1998.</span>
0039 <span class="comment">%    http://dx.doi.org/10.1080/01621459.1998.10473803</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% See also: stk_sampling_randomlhs, stk_sampling_maximinlhs</span>
0042 
0043 <span class="comment">% Copyright Notice</span>
0044 <span class="comment">%</span>
0045 <span class="comment">%    Copyright (C) 2012, 2013 SUPELEC</span>
0046 <span class="comment">%</span>
0047 <span class="comment">%    Author:  Julien Bect  &lt;julien.bect@supelec.fr&gt;</span>
0048 
0049 <span class="comment">% Copying Permission Statement</span>
0050 <span class="comment">%</span>
0051 <span class="comment">%    This file is part of</span>
0052 <span class="comment">%</span>
0053 <span class="comment">%            STK: a Small (Matlab/Octave) Toolbox for Kriging</span>
0054 <span class="comment">%               (http://sourceforge.net/projects/kriging)</span>
0055 <span class="comment">%</span>
0056 <span class="comment">%    STK is free software: you can redistribute it and/or modify it under</span>
0057 <span class="comment">%    the terms of the GNU General Public License as published by the Free</span>
0058 <span class="comment">%    Software Foundation,  either version 3  of the License, or  (at your</span>
0059 <span class="comment">%    option) any later version.</span>
0060 <span class="comment">%</span>
0061 <span class="comment">%    STK is distributed  in the hope that it will  be useful, but WITHOUT</span>
0062 <span class="comment">%    ANY WARRANTY;  without even the implied  warranty of MERCHANTABILITY</span>
0063 <span class="comment">%    or FITNESS  FOR A  PARTICULAR PURPOSE.  See  the GNU  General Public</span>
0064 <span class="comment">%    License for more details.</span>
0065 <span class="comment">%</span>
0066 <span class="comment">%    You should  have received a copy  of the GNU  General Public License</span>
0067 <span class="comment">%    along with STK.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0068 
0069 <a name="_sub0" href="#_subfunctions" class="code">function x = stk_sampling_olhs(n, d, box, permut)</a>
0070 stk_narginchk(1, 4);
0071 
0072 <span class="comment">%%% PROCESS INPUT ARGUMENTS %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0073 
0074 <span class="comment">% recover the &quot;order&quot; r from the value of n</span>
0075 r = floor(log2(n - 1) - 1);
0076 n_ = 2^(r + 1) + 1;
0077 <span class="keyword">if</span> (r == 0) || (abs(n - n_) &gt; eps),
0078     errmsg = <span class="string">'n must be an integer of the form 2^(r+1) + 1 with r &gt; 0'</span>;
0079     stk_error(errmsg, <span class="string">'IncorrectArgument'</span>);
0080 <span class="keyword">end</span>
0081 n = n_;
0082 
0083 <span class="comment">% check that d has the correct value for a &quot;full&quot; Ye98-OLHS</span>
0084 <span class="comment">% (other values of d can be reached by removing columns from a full OLHS)</span>
0085 <span class="keyword">if</span> (nargin &gt; 1) &amp;&amp; ~isempty(d),
0086     <span class="keyword">if</span> d ~= 2 * r,
0087         errmsg = <span class="string">'Incorrect value of d, please read the documentation...'</span>;
0088         stk_error(errmsg, <span class="string">'IncorrectArgument'</span>);
0089     <span class="keyword">end</span>
0090 <span class="keyword">else</span>
0091     d = 2 * r;
0092 <span class="keyword">end</span>
0093 
0094 <span class="comment">% number of &quot;positive levels&quot;</span>
0095 q = 2^r; <span class="comment">% = (n - 1)/2</span>
0096 
0097 <span class="comment">% box</span>
0098 <span class="keyword">if</span> (nargin &lt; 3) || isempty(box),
0099     box = repmat([-1; 1], 1, d);
0100 <span class="keyword">else</span>
0101     stk_assert_box(box);
0102 <span class="keyword">end</span>
0103 
0104 <span class="comment">% permutation</span>
0105 <span class="keyword">if</span> nargin &lt; 4,
0106     permut = randperm(q)';
0107 <span class="keyword">else</span>
0108     permut = permut(:);
0109     <span class="keyword">if</span> ~isequal(sort(permut), (1:q)'),
0110         errmsg = sprintf(<span class="string">'permut should be a permutation of 1:%d.'</span>, q);
0111         stk_error(errmsg, <span class="string">'IncorrectArgument'</span>);
0112     <span class="keyword">end</span>
0113 <span class="keyword">end</span>
0114 
0115 <span class="comment">%%% CONSTRUCT AN &quot;ORTHOGONAL&quot; LHS FOLLOWING PROCESS INPUT ARGUMENTS %%%%%%%%%%%</span>
0116 
0117 <span class="comment">% Construct permutation matrices A1, A2, ..., Ar</span>
0118 A = cell(1, r);
0119 <span class="keyword">for</span> i = 1:r,
0120     Ai = 1;
0121     <span class="keyword">for</span> j = 1:i,
0122         Z  = zeros(size(Ai));
0123         Ai = [Z Ai; Ai Z]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0124     <span class="keyword">end</span>
0125     <span class="keyword">for</span> j = (i+1):r,
0126         Z  = zeros(size(Ai));
0127         Ai = [Ai Z; Z Ai]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0128     <span class="keyword">end</span>
0129     A{i} = Ai;
0130 <span class="keyword">end</span>
0131 
0132 <span class="comment">% Construct the matrix M</span>
0133 M = [permut zeros(q, 2*r-1)];
0134 <span class="keyword">for</span> j = 1:r, <span class="comment">% from column 2 to column r+1</span>
0135     M(:, j+1) = A{j} * permut;
0136 <span class="keyword">end</span>
0137 <span class="keyword">for</span> j = 1:(r-1), <span class="comment">% from column r+2 to column 2*r</span>
0138     M(:, j+r+1) = A{j} * A{r} * permut;
0139 <span class="keyword">end</span>
0140 
0141 <span class="comment">% Construct the matrix S</span>
0142 S = ones(q, 2*r);
0143 <span class="keyword">for</span> j = 1:r, <span class="comment">% from column 2 to column r+1</span>
0144     aj = 1;
0145     <span class="keyword">for</span> l = r:(-1):1,
0146         <span class="keyword">if</span> l == r - j + 1,
0147             aj = [-aj; aj]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0148         <span class="keyword">else</span>
0149             aj = [aj; aj]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0150         <span class="keyword">end</span>
0151     <span class="keyword">end</span>
0152     S(:, j+1) = aj;
0153 <span class="keyword">end</span>
0154 <span class="keyword">for</span> j = 2:r, <span class="comment">% from column r+2 to column 2*r</span>
0155     S(:, r+j) = S(:, 2) .* S(:, j+1);
0156 <span class="keyword">end</span>
0157 
0158 <span class="comment">% Construct the matrix T</span>
0159 T = M .* S;
0160 
0161 <span class="comment">% Construct the OLHS X (with integer levels -q, ..., 0, ... +q)</span>
0162 x = [T; zeros(1, 2*r); -T];
0163 
0164 <span class="comment">%%% CONVERT TO THE REQUESTED BOX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0165 
0166 <span class="comment">% Convert to positive integer levels (1 ... n)</span>
0167 x = x + q + 1;
0168 
0169 <span class="comment">% Convert to [0; 1]-valued levels</span>
0170 x = (2*x - 1) / (2*n);
0171 
0172 <span class="comment">% And, finally, convert to box</span>
0173 x = struct(<span class="string">'a'</span>, stk_rescale(x, [], box));
0174     
0175 <span class="keyword">end</span> <span class="comment">% function stk_sampling_olhs</span>
0176 
0177 
0178 
0179 <span class="comment">%%%%%%%%%%%%%</span>
0180 <span class="comment">%%% tests %%%</span>
0181 <span class="comment">%%%%%%%%%%%%%</span>
0182 
0183 <span class="comment">%%</span>
0184 <span class="comment">% Check error for incorrect number of input arguments</span>
0185 
0186 <span class="comment">%!shared x, n, d, box, permut</span>
0187 <span class="comment">%! n = 5; d = 2; box = [0 0; 1, 1]; permut = 1:2;</span>
0188 
0189 <span class="comment">%!error x = stk_sampling_olhs();</span>
0190 <span class="comment">%!test  x = stk_sampling_olhs(n);</span>
0191 <span class="comment">%!test  x = stk_sampling_olhs(n, d);</span>
0192 <span class="comment">%!test  x = stk_sampling_olhs(n, d, box);</span>
0193 <span class="comment">%!test  x = stk_sampling_olhs(n, d, box, permut);</span>
0194 <span class="comment">%!error x = stk_sampling_olhs(n, d, box, permut, pi);</span>
0195 
0196 <span class="comment">%%</span>
0197 <span class="comment">% Check that the output is a struct with a numeric '.a' field</span>
0198 <span class="comment">% (all stk_sampling_* functions should behave similarly in this respect)</span>
0199 
0200 <span class="comment">%!test assert(isstruct(x) &amp;&amp; isnumeric(x.a));</span>
0201 
0202 <span class="comment">%%</span>
0203 <span class="comment">% Check output argument</span>
0204 
0205 <span class="comment">%!test</span>
0206 <span class="comment">%! for r = 1:5</span>
0207 <span class="comment">%!</span>
0208 <span class="comment">%!   n = 2^(r+1) + 1; d = 2*r;</span>
0209 <span class="comment">%!   x = stk_sampling_olhs(n, d);</span>
0210 <span class="comment">%!</span>
0211 <span class="comment">%!   assert(isequal(size(x.a), [n d]));</span>
0212 <span class="comment">%!</span>
0213 <span class="comment">%!   box = repmat([-1; 1], 1, d);</span>
0214 <span class="comment">%!   assert(stk_is_lhs(x, n, d, box));</span>
0215 <span class="comment">%!</span>
0216 <span class="comment">%!   w = (x.a)' * x.a;</span>
0217 <span class="comment">%!   assert(stk_isequal_tolabs(w/w(1,1), eye(d)));</span>
0218 <span class="comment">%!</span>
0219 <span class="comment">%! end</span></pre></div>
<hr><address>Generated on Thu 03-Jan-2013 16:25:06 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>