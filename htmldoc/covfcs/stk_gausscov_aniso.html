<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of stk_gausscov_aniso</title>
  <meta name="keywords" content="stk_gausscov_aniso">
  <meta name="description" content="STK_GAUSSCOV_ANISO computes the anisotropic Gaussian covariance function">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">covfcs</a> &gt; stk_gausscov_aniso.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for covfcs&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>stk_gausscov_aniso
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>STK_GAUSSCOV_ANISO computes the anisotropic Gaussian covariance function</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function k = stk_gausscov_aniso (param, x, y, diff, pairwise) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> STK_GAUSSCOV_ANISO computes the anisotropic Gaussian covariance function

 CALL: K = stk_gausscov_aniso (PARAM, X, Y)

   computes  the covariance matrix K  between  the sets of locations  X  and Y,
   using  the anisotropic Gaussian covariance  function  with parameters PARAM.
   The output matrix K has size  NX x NY,  where NX is the number of rows  in X
   and NY  the number of rows in Y.  The vector of parameters must have DIM + 1
   elements, where DIM is the common number of columns of X and Y:

     * PARAM(1) = log (SIGMA ^ 2), where SIGMA is the standard deviation,

     * PARAM(2:END) = - log (RHO), where RHO is the vector of range parameters.

 CALL: dK = stk_gausscov_aniso (PARAM, X, Y, DIFF)

   computes the derivative of the covariance matrix with respect to PARAM(DIFF)
   if DIFF is between 1 and DIM + 1, or the covariance matrix itself if DIFF is
   equal to -1  (in which case this is equivalent to stk_gausscov_aniso (PARAM,
   X, Y)).

 CALL: K = stk_gausscov_aniso (PARAM, X, Y, DIFF, PAIRWISE)

   computes the covariance vector  (or a derivative of it if DIFF &gt; 0)  between
   the sets of locations X and Y.  The output K is a vector of length N,  where
   N is the common number of rows of X and Y.

 See also: stk_sf_gausscorr, <a href="stk_gausscov_iso.html" class="code" title="function k = stk_gausscov_iso (param, x, y, diff, pairwise)">stk_gausscov_iso</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../octave-sombrero.png)">
</ul>
This function is called by:
<ul style="list-style-image:url(../octave-sombrero.png)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% STK_GAUSSCOV_ANISO computes the anisotropic Gaussian covariance function</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% CALL: K = stk_gausscov_aniso (PARAM, X, Y)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   computes  the covariance matrix K  between  the sets of locations  X  and Y,</span>
0006 <span class="comment">%   using  the anisotropic Gaussian covariance  function  with parameters PARAM.</span>
0007 <span class="comment">%   The output matrix K has size  NX x NY,  where NX is the number of rows  in X</span>
0008 <span class="comment">%   and NY  the number of rows in Y.  The vector of parameters must have DIM + 1</span>
0009 <span class="comment">%   elements, where DIM is the common number of columns of X and Y:</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%     * PARAM(1) = log (SIGMA ^ 2), where SIGMA is the standard deviation,</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%     * PARAM(2:END) = - log (RHO), where RHO is the vector of range parameters.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% CALL: dK = stk_gausscov_aniso (PARAM, X, Y, DIFF)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%   computes the derivative of the covariance matrix with respect to PARAM(DIFF)</span>
0018 <span class="comment">%   if DIFF is between 1 and DIM + 1, or the covariance matrix itself if DIFF is</span>
0019 <span class="comment">%   equal to -1  (in which case this is equivalent to stk_gausscov_aniso (PARAM,</span>
0020 <span class="comment">%   X, Y)).</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% CALL: K = stk_gausscov_aniso (PARAM, X, Y, DIFF, PAIRWISE)</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%   computes the covariance vector  (or a derivative of it if DIFF &gt; 0)  between</span>
0025 <span class="comment">%   the sets of locations X and Y.  The output K is a vector of length N,  where</span>
0026 <span class="comment">%   N is the common number of rows of X and Y.</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% See also: stk_sf_gausscorr, stk_gausscov_iso</span>
0029 
0030 <span class="comment">% Copyright Notice</span>
0031 <span class="comment">%</span>
0032 <span class="comment">%    Copyright (C) 2013 SUPELEC</span>
0033 <span class="comment">%</span>
0034 <span class="comment">%    Authors:   Julien Bect       &lt;julien.bect@supelec.fr&gt;</span>
0035 <span class="comment">%               Emmanuel Vazquez  &lt;emmanuel.vazquez@supelec.fr&gt;</span>
0036 
0037 <span class="comment">% Copying Permission Statement</span>
0038 <span class="comment">%</span>
0039 <span class="comment">%    This file is part of</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%            STK: a Small (Matlab/Octave) Toolbox for Kriging</span>
0042 <span class="comment">%               (http://sourceforge.net/projects/kriging)</span>
0043 <span class="comment">%</span>
0044 <span class="comment">%    STK is free software: you can redistribute it and/or modify it under</span>
0045 <span class="comment">%    the terms of the GNU General Public License as published by the Free</span>
0046 <span class="comment">%    Software Foundation,  either version 3  of the License, or  (at your</span>
0047 <span class="comment">%    option) any later version.</span>
0048 <span class="comment">%</span>
0049 <span class="comment">%    STK is distributed  in the hope that it will  be useful, but WITHOUT</span>
0050 <span class="comment">%    ANY WARRANTY;  without even the implied  warranty of MERCHANTABILITY</span>
0051 <span class="comment">%    or FITNESS  FOR A  PARTICULAR PURPOSE.  See  the GNU  General Public</span>
0052 <span class="comment">%    License for more details.</span>
0053 <span class="comment">%</span>
0054 <span class="comment">%    You should  have received a copy  of the GNU  General Public License</span>
0055 <span class="comment">%    along with STK.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0056 
0057 <a name="_sub0" href="#_subfunctions" class="code">function k = stk_gausscov_aniso (param, x, y, diff, pairwise)</a>
0058 
0059 <span class="keyword">if</span> nargin &gt; 5,
0060     stk_error (<span class="string">'Too many input arguments.'</span>, <span class="string">'TooManyInputArgs'</span>);
0061 <span class="keyword">end</span>
0062 
0063 <span class="keyword">persistent</span> x0 y0 xs ys param0 pairwise0 D Kx_cache compute_Kx_cache
0064 
0065 <span class="comment">% process input arguments</span>
0066 x = double (x);
0067 y = double (y);
0068 <span class="keyword">if</span> nargin &lt; 4, diff = -1; <span class="keyword">end</span>
0069 <span class="keyword">if</span> nargin &lt; 5, pairwise = false; <span class="keyword">end</span>
0070 
0071 <span class="comment">% check consistency for the number of factors</span>
0072 dim = size (x, 2);
0073 <span class="keyword">if</span> size (y, 2) ~= dim,
0074     stk_error (<span class="string">'xi and yi have incompatible sizes.'</span>, <span class="string">'InvalidArgument'</span>);
0075 <span class="keyword">end</span>
0076 nb_params = dim + 1;
0077 <span class="keyword">if</span> length (param) ~= nb_params
0078     stk_error (<span class="string">'xi and param have incompatible sizes.'</span>, <span class="string">'InvalidArgument'</span>);
0079 <span class="keyword">end</span>
0080 
0081 <span class="comment">% extract parameters from the &quot;param&quot; vector</span>
0082 Sigma2 = exp (param(1));
0083 invRho = exp (param(2:end));
0084 
0085 <span class="comment">% check parameter values</span>
0086 <span class="keyword">if</span> ~ (Sigma2 &gt; 0) || ~ all (invRho &gt; 0),
0087     error (<span class="string">'Incorrect parameter value.'</span>);
0088 <span class="keyword">end</span>
0089 
0090 invRho = diag (invRho);
0091 
0092 <span class="comment">% check if all input arguments are the same as before</span>
0093 <span class="comment">% (or if this is the first call to the function)</span>
0094 <span class="keyword">if</span> isempty (x0) || isempty (y0) || isempty (param0) || <span class="keyword">...</span>
0095         ~ isequal ({x, y, param}, {x0, y0, param0}) || <span class="keyword">...</span>
0096         ~ isequal (pairwise, pairwise0)
0097     <span class="comment">% compute the distance matrix</span>
0098     xs = x * invRho;  ys = y * invRho;
0099     D = stk_dist (xs, ys, pairwise);
0100     <span class="comment">% save arguments for the next call</span>
0101     x0 = x;  y0 = y;  param0 = param;  pairwise0 = pairwise;
0102     <span class="comment">% recomputation of Kx_cache is required</span>
0103     compute_Kx_cache = true;
0104 <span class="keyword">end</span>
0105 
0106 <span class="keyword">if</span> diff == -1,
0107     <span class="comment">% Compute the value (not a derivative)</span>
0108     k = Sigma2 * stk_sf_gausscorr (D, -1);
0109 <span class="keyword">elseif</span> diff == 1,
0110     <span class="comment">% Differentiate wrt param(1) = log (Sigma2)</span>
0111     k = Sigma2 * stk_sf_gausscorr (D, -1);
0112 <span class="keyword">elseif</span> (diff &gt;= 2) &amp;&amp; (diff &lt;= nb_params),
0113     <span class="comment">% Differentiate wrt param(diff) = - log (invRho(diff-1))</span>
0114     ind = diff - 1;
0115     <span class="keyword">if</span> compute_Kx_cache || isempty (Kx_cache)
0116         Kx_cache  = 1 ./ (D + eps) .* (Sigma2 * stk_sf_gausscorr (D, 1));
0117         compute_Kx_cache = false;
0118     <span class="keyword">end</span>
0119     nx = size (x, 1);  ny = size (y, 1);
0120     <span class="keyword">if</span> pairwise,
0121         k = ((xs(:, ind) - ys(:, ind)) .^ 2) .* Kx_cache;
0122     <span class="keyword">else</span>
0123         k = (repmat (xs(:, ind), 1, ny) - repmat (ys(:, ind)', nx, 1)) .^ 2 <span class="keyword">...</span>
0124             .* Kx_cache;
0125     <span class="keyword">end</span>
0126 <span class="keyword">else</span>
0127     stk_error (<span class="string">'Incorrect value for the ''diff'' parameter.'</span>, <span class="keyword">...</span>
0128         <span class="string">'InvalidArgument'</span>);
0129 <span class="keyword">end</span>
0130 
0131 <span class="keyword">end</span> <span class="comment">% function stk_gausscov_aniso</span>
0132 
0133 
0134 <span class="comment">%%</span>
0135 <span class="comment">% 1D, 5x5</span>
0136 
0137 
0138 
0139 
0140 
0141 
0142 
0143 
0144 
0145 
0146 
0147 
0148 
0149 
0150 
0151 
0152 
0153 
0154 
0155 
0156 
0157 
0158 
0159 
0160 
0161 
0162 
0163 
0164 
0165 
0166 
0167 
0168 
0169 
0170 
0171 <span class="comment">%%</span>
0172 <span class="comment">% 3D, 4x10</span></pre></div>
<hr>

<address>
   HTML documentation for <strong>STK 2.1</strong>,
   generated by <strong>
   <a href="http://www.artefact.tk/software/matlab/m2html/" title="M2HTML website">M2HTML 1.5</a></strong>
</address>

</body>
</html>