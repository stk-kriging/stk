<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of stk_example_kb04</title>
  <meta name="keywords" content="stk_example_kb04">
  <meta name="description" content="STK_EXAMPLE_KB04  Estimating the variance of the noise">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">examples</a> &gt; <a href="index.html">01_kriging_basics</a> &gt; stk_example_kb04.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for examples/01_kriging_basics&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>stk_example_kb04
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>STK_EXAMPLE_KB04  Estimating the variance of the noise</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> STK_EXAMPLE_KB04  Estimating the variance of the noise

 This example constructs an ordinary kriging approximation in 1D, with
 covariance parameters and noise variance estimated from the data.

 A Matern covariance function is used for the Gaussian Process (GP) prior. The
 parameters of this covariance function are estimated using the Restricted
 Maximum Likelihood (ReML) method.

 The mean function of the GP prior is assumed to be constant and unknown.

 In this example, the variance of the observation noise is not assumed to be
 known, and is instead estimated from the data together the parameters of the
 covariance function. This is triggered by the used of the fifth (optional)
 argument in the call to stk_param_estim.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../octave-sombrero.png)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../octave-sombrero.png)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% STK_EXAMPLE_KB04  Estimating the variance of the noise</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% This example constructs an ordinary kriging approximation in 1D, with</span>
0004 <span class="comment">% covariance parameters and noise variance estimated from the data.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% A Matern covariance function is used for the Gaussian Process (GP) prior. The</span>
0007 <span class="comment">% parameters of this covariance function are estimated using the Restricted</span>
0008 <span class="comment">% Maximum Likelihood (ReML) method.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% The mean function of the GP prior is assumed to be constant and unknown.</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% In this example, the variance of the observation noise is not assumed to be</span>
0013 <span class="comment">% known, and is instead estimated from the data together the parameters of the</span>
0014 <span class="comment">% covariance function. This is triggered by the used of the fifth (optional)</span>
0015 <span class="comment">% argument in the call to stk_param_estim.</span>
0016 
0017 <span class="comment">% Copyright Notice</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%    Copyright (C) 2011-2013 SUPELEC</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%    Authors:   Julien Bect       &lt;julien.bect@supelec.fr&gt;</span>
0022 <span class="comment">%               Emmanuel Vazquez  &lt;emmanuel.vazquez@supelec.fr&gt;</span>
0023 
0024 <span class="comment">% Copying Permission Statement</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%    This file is part of</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%            STK: a Small (Matlab/Octave) Toolbox for Kriging</span>
0029 <span class="comment">%               (http://sourceforge.net/projects/kriging)</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%    STK is free software: you can redistribute it and/or modify it under</span>
0032 <span class="comment">%    the terms of the GNU General Public License as published by the Free</span>
0033 <span class="comment">%    Software Foundation,  either version 3  of the License, or  (at your</span>
0034 <span class="comment">%    option) any later version.</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%    STK is distributed  in the hope that it will  be useful, but WITHOUT</span>
0037 <span class="comment">%    ANY WARRANTY;  without even the implied  warranty of MERCHANTABILITY</span>
0038 <span class="comment">%    or FITNESS  FOR A  PARTICULAR PURPOSE.  See  the GNU  General Public</span>
0039 <span class="comment">%    License for more details.</span>
0040 <span class="comment">%</span>
0041 <span class="comment">%    You should  have received a copy  of the GNU  General Public License</span>
0042 <span class="comment">%    along with STK.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
0043 
0044 stk_disp_examplewelcome;  stk_figure (<span class="string">'stk_example_kb04'</span>);
0045 
0046 
0047 <span class="comment">%% Define a 1d test function</span>
0048 
0049 f = @(x)(- (0.8 * x + sin (5 * x + 1) + 0.1 * sin (10 * x)));
0050 DIM = 1;            <span class="comment">% dimension of the factor space</span>
0051 BOX = [-1.0; 1.0];  <span class="comment">% factor space</span>
0052 
0053 NT = 400;  <span class="comment">% nb of points in the grid</span>
0054 xt = stk_sampling_regulargrid (NT, DIM, BOX);
0055 zt = stk_feval (f, xt);
0056 
0057 
0058 <span class="comment">%% Generate a random sampling plan</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% The objective is to construct an approximation of f with a budget of NI</span>
0061 <span class="comment">% evaluations performed on a randomly generated (uniform) design.</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% Change the value of NOISEVARIANCE to add a Gaussian evaluation noise on</span>
0064 <span class="comment">% the observations.</span>
0065 <span class="comment">%</span>
0066 
0067 NOISEVARIANCE = 0.05;
0068 
0069 NI = 30;                                    <span class="comment">% nb of evaluations</span>
0070 xi = stk_sampling_randunif (NI, DIM, BOX);  <span class="comment">% evaluation points</span>
0071 zi = stk_feval (f, xi);                     <span class="comment">% evaluation results</span>
0072 
0073 zi = zi + sqrt (NOISEVARIANCE) * randn (NI, 1);
0074 
0075 
0076 <span class="comment">%% Specification of the model</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% We choose a Matern covariance, the parameters of which will be estimated from</span>
0079 <span class="comment">% the data.</span>
0080 <span class="comment">%</span>
0081 <span class="comment">% The values of the parameters that are provided here, including the noise</span>
0082 <span class="comment">% variance, are only used as an initial point for the optimization algorithm</span>
0083 <span class="comment">% used in stk_param_estim().</span>
0084 <span class="comment">%</span>
0085 
0086 <span class="comment">% The following line defines a model with a constant but unknown mean (ordinary</span>
0087 <span class="comment">% kriging) and a Matern covariance function. (Some default parameters are also</span>
0088 <span class="comment">% set, but they will be replaced below by estimated parameters.)</span>
0089 model = stk_model (<span class="string">'stk_materncov_iso'</span>);
0090 
0091 <span class="comment">% Noise variance</span>
0092 model.lognoisevariance = log (100 * eps);
0093 <span class="comment">% (this is not the true value of the noise variance !)</span>
0094 
0095 
0096 <span class="comment">%% Estimate the parameters of the covariance function</span>
0097 <span class="comment">%</span>
0098 <span class="comment">% Here, the parameters of the Matern covariance function are estimated by the</span>
0099 <span class="comment">% REML (REstricted Maximum Likelihood) method using stk_param_estim().</span>
0100 <span class="comment">%</span>
0101 
0102 <span class="comment">% Initial guess for the parameters for the Matern covariance</span>
0103 <span class="comment">% (see &quot;help stk_materncov_iso&quot; for more information)</span>
0104 SIGMA2 = 1.0;  <span class="comment">% variance parameter</span>
0105 NU     = 4.0;  <span class="comment">% regularity parameter</span>
0106 RHO1   = 0.4;  <span class="comment">% scale (range) parameter</span>
0107 param0 = log ([SIGMA2; NU; 1/RHO1]);
0108 
0109 <span class="comment">% Initial guess for the (log of the) noise variance</span>
0110 lnv0 = 2 * log (std (zi) / 100);
0111 
0112 [param, paramlnv] = stk_param_estim (model, xi, zi, param0, lnv0);
0113 
0114 model.param = param;
0115 model.lognoisevariance = paramlnv;
0116 
0117 
0118 <span class="comment">%% Carry out kriging prediction</span>
0119 
0120 zp = stk_predict (model, xi, zi, xt);
0121 
0122 <span class="comment">% Visualisation</span>
0123 stk_plot1d (xi, zi, xt, zt, zp);
0124 stk_title  (<span class="string">'Kriging prediction'</span>);
0125 stk_labels (<span class="string">'input variable x'</span>, <span class="string">'response z'</span>);
0126 
0127 model <span class="comment">%#ok&lt;NOPTS&gt;</span></pre></div>
<hr>

<address>
   HTML documentation for <strong>STK 2.1.1</strong>,
   generated by <strong>
   <a href="http://www.artefact.tk/software/matlab/m2html/" title="M2HTML website">M2HTML 1.5</a></strong>
</address>

</body>
</html>